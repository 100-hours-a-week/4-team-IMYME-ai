# ğŸ§  IMYME AI Server

![Python](https://img.shields.io/badge/Python-3.13-3776AB?logo=python&logoColor=white)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109-009688?logo=fastapi&logoColor=white)
![Gemini](https://img.shields.io/badge/Gemini-Pro%2F2.5%20Flash-4285F4?logo=google&logoColor=white)
![RunPod](https://img.shields.io/badge/RunPod-Serverless-7B16FF?logo=runpod&logoColor=white)
![Whisper](https://img.shields.io/badge/Whisper-Large%20v3-FF9E0F?logo=openai&logoColor=white)

> **"Speak, Learn, Improve."**
> 
> IMYME ì„œë¹„ìŠ¤ì˜ í•µì‹¬ ë‘ë‡Œ ì—­í• ì„ í•˜ëŠ” **AI ì¶”ë¡  ë° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„œë²„**ì…ë‹ˆë‹¤.
> ê³ ì„±ëŠ¥ STT ì—”ì§„ê³¼ Gemini ê¸°ë°˜ì˜ ì§€ì‹ í‰ê°€ ì‹œìŠ¤í…œì„ í†µí•´ ì‚¬ìš©ìì—ê²Œ ì‹¤ì‹œê°„ í”¼ë“œë°±ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## âœ¨ Key AI Features

ì´ í”„ë¡œì íŠ¸ëŠ” ë‹¨ìˆœí•œ API ì„œë²„ê°€ ì•„ë‹ˆë¼, **ë³µí•©ì ì¸ AI íŒŒì´í”„ë¼ì¸**ì„ ì²˜ë¦¬í•˜ëŠ” ì—”ì§„ì…ë‹ˆë‹¤.

### 1. âš¡ï¸ High-Performance Dual-Model Engine
- **Speed & Cost**: ì‹¤ì‹œê°„ í”¼ë“œë°± ìƒì„±ê³¼ ì ìˆ˜ ì‚°ì •ì—ëŠ” **Gemini 2.5 Flash**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µ ì†ë„ë¥¼ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤.
- **Deep Reasoning**: ë³µì¡í•œ ì§€ì‹ ê²€ì¦ ë° í‰ê°€(RAG)ì—ëŠ” **Gemini 3 Pro**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì •í™•í•œ íŒë‹¨ë ¥ì„ ë³´ì¥í•©ë‹ˆë‹¤.
- **Flexible Architecture**: ëª¨ë“ˆí˜• ì„¤ê³„ë¥¼ í†µí•´ ìƒí™©ì— ë”°ë¼ ëª¨ë¸ì„ ììœ ë¡­ê²Œ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 2. ğŸ¯ Advanced RAG System (Multi-Decision)
- **Knowledge Verification**: ì‚¬ìš©ìê°€ ë§í•œ ë‚´ìš©ì´ ì˜¬ë°”ë¥¸ ì§€ì‹ì¸ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
- **Multi-Candidate Evaluation**: ë‹¨ìˆœíˆ ê°€ì¥ ìœ ì‚¬í•œ ì§€ì‹ 1ê°œë§Œ ë¹„êµí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **Top-Nê°œì˜ í›„ë³´êµ°**ì„ ë…ë¦½ì ìœ¼ë¡œ í‰ê°€í•˜ì—¬ ì •ë³´ì˜ ì •í•©ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

### 3. ğŸ™ï¸ Robust STT Pipeline
- **Whisper Large v3 Turbo**: ìµœì‹  Whisper ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í•œêµ­ì–´ ë° ê¸°ìˆ  ìš©ì–´ ì¸ì‹ë¥ ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.
- **Silero VAD Integration**: Voice Activity Detectionì„ í†µí•´ ë¹„ìŒì„± êµ¬ê°„(ì¹¨ë¬µ, ë°°ê²½ìŒì•…)ì„ ì œê±°í•˜ì—¬ **Hallucination(í™˜ê°)** í˜„ìƒì„ ì›ì²œ ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤.

### 4. â˜ï¸ Scalable Serverless Infrastructure
- **RunPod Serverless**: GPUê°€ í•„ìš”í•œ STT ì›Œì»¤ëŠ” RunPod ìœ„ì—ì„œ ë™ì‘í•˜ë©°, íŠ¸ë˜í”½ì— ë”°ë¼ **0ê°œì—ì„œ Nê°œê¹Œì§€ ì˜¤í† ìŠ¤ì¼€ì¼ë§** ë©ë‹ˆë‹¤.
- **Cost Efficiency**: ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•ŒëŠ” ë¹„ìš©ì´ 0ì›ì— ìˆ˜ë ´í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

---

## ğŸ—ï¸ Architecture

ì‹œìŠ¤í…œì€ í¬ê²Œ **AI Server(Controller)**ì™€ **STT Worker(GPU)**ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```mermaid
graph LR
    User[Client] -->|Audio/Text| GW[API Gateway]
    GW -->|REST API| AI[AI Server (FastAPI)]
    
    subgraph "AI Core"
        AI -->|Generate| GEMINI[Google Gemini API]
        AI -->|Retrieve| DB[(PostgreSQL + pgvector)]
    end
    
    subgraph "GPU Workload"
        AI -->|Job Request| RP[RunPod Serverless]
        RP -->|Auto-Scale| W1[STT Worker 1]
        RP -->|Auto-Scale| W2[STT Worker 2]
    end
```

1.  **AI Server (`ai_server/`)**: í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ ì²˜ë¦¬, í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§, RAG ë¡œì§, LLM í†µì‹  ë‹´ë‹¹.
2.  **STT Worker (`stt_server/`)**: ë¬´ê±°ìš´ ìŒì„± ì¸ì‹ ëª¨ë¸(Whisper)ì„ ì „ë‹´ ì²˜ë¦¬í•˜ëŠ” GPU ì»¨í…Œì´ë„ˆ.

---

## ğŸš€ Getting Started

### Prerequisites
- Python 3.10+
- Docker (for deployment)
- RunPod Account & API Key
- Google Gemini API Key

### 1. Installation

```bash
# Clone Repository
git clone https://github.com/100-hours-a-week/4-team-IMYME-ai.git
cd 4-team-IMYME-ai

# Install Dependencies
pip install -r ai_server/requirements.txt
```

### 2. Configuration (.env)

`ai_server/.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  í‚¤ë¥¼ ì„¤ì •í•˜ì„¸ìš”.

```ini
# Gemini
GEMINI_API_KEY=your_gemini_key

# RunPod STT
RUNPOD_API_KEY=your_runpod_key
RUNPOD_ENDPOINT_ID=your_endpoint_id

# Security
INTERNAL_SECRET_KEY=your_secret_key
```

### 3. Run AI Server (Local)

```bash
cd ai_server
python -m app.main
```
ì„œë²„ê°€ ì‹¤í–‰ë˜ë©´ `http://localhost:8000/docs`ì—ì„œ API ë¬¸ì„œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“¦ Deployment (STT Worker)

STT ì„œë²„ëŠ” RunPod Serverless í™˜ê²½ì— ë°°í¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

**Build & Push**
```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰
docker build --platform linux/amd64 -t your-repo/whisper-worker:v1.0 -f stt_server/Dockerfile .
docker push your-repo/whisper-worker:v1.0
```

RunPod ì½˜ì†”ì—ì„œ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ Serverless Endpointë¥¼ ìƒì„±í•˜ì„¸ìš”.

---

## ğŸ“š API Guidelines

| Method | Endpoint | Description |
| :--- | :--- | :--- |
| `POST` | `/api/v1/transcriptions` | ì˜¤ë””ì˜¤ URLì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (STT) |
| `POST` | `/api/v1/solo/submissions` | ì‚¬ìš©ì ë‹µë³€ ë¶„ì„ ë° í”¼ë“œë°± ìƒì„± (AI Coaching) |
| `POST` | `/api/v1/knowledge/candidates/batch` | ëŒ€ëŸ‰ì˜ ì§€ì‹ ë°ì´í„°ë¥¼ ì„ë² ë”© ë° ì •ì œ (RAG) |
| `POST` | `/api/v1/gpu/warmup` | GPU Cold Start ë°©ì§€ë¥¼ ìœ„í•œ ì›Œë°ì—… |

---

## ğŸ“ Troubleshooting

ì£¼ìš” ì´ìŠˆ ë° í•´ê²° ë°©ë²•ì€ [TROUBLESHOOTING.md](./TROUBLESHOOTING.md) íŒŒì¼ì„ ì°¸ê³ í•˜ì„¸ìš”.

- `NameError: settings not defined` í•´ê²°ë²•
- STT Hallucination ë°©ì§€ íŒ
- Docker ë¹Œë“œ ì´ìŠˆ ë“±
